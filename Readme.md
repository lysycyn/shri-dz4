# ШРИ 2018. ДЗ 4 - ДЗ 6

Demo
- staging(dev): https://shri-dz4-dev.herokuapp.com/
- production: https://shri-dz4-product.herokuapp.com/

## Запуск

## Перед локальным запуском ОБЯЗАТЕЛЬНО поменять путь до репозитория в файле /config.js

1. Распаковать тестоый репозиторий
```
tar -xvf repo.tar
```
2. Установить пакеты
```
npm i
```
3. Dev-сборка, адрес http://0.0.0.0:3000/
```
npm run dev
```
4. Линтеры (eslint, stylelint) запускаются при сборке проекта
```
npm run lint:css
npm run lint:js
```
5. Запуск тестов

```
selenium-standalone start
tar -xvf repo.tar
npm run build
npm run test:unit
npm run test:hermione
```
6. Product-сборка, адрес http://0.0.0.0:3000/
```
npm run build
npm start
```

# ДЗ 4. node.js. Приложение для отображения локального git-репозитория. Перечень функционала

1. node + express приложение.
2. Серверная шаблонизация с помощью pug.
3. Для операций git используется промис-обертка над функцией exec.
4. Настройка (пока что это просто путь до репозитория) вынесена в отдельный файл config.js.
5. На главной странице отображается список веток репозитория, каждая из них кликабельна.
6. На странице ветки отображается список комитов.
7. На странице комита отображается дерево файлов + хлебные крошки.
8. Можно перейти во вложенные папки внутри комита.
9. Отображается содержмиое файлов

10. Предусмотрено корректное отображение содержимое веток вида feat/test-branch (чтобы node.js правильно распарсил ссылку, этот параметр обернут с помощью encodeURIComponent).
11. Просмотр файлов и директорий осущетсвляется по одному и тому же роуту 'tree/params', для просмотра файла выставляется флаг file в урле

# ДЗ 5. Инфраструктура.

1. При коммите запускается precommit-хук, который запускает линтеры. При пуше на гитхаб Travis подхватывает пуш. На стороне Travis происходит:
- Проверка кода (линтеры, тесты);
- Сборка проекта (webpack);
- Развертывание стенда на Heroku на основе Docker-контейнера (pipeline);

Дополнительно:
2. При выставлении тега происходит деплой приложения в Heroku (production)

# ДЗ 6. Тестирование.

## Модульное тестирование
Произведена настройка модульных тестов с помощью mocha, chai, nyc

1. Функция utils/helpers/getBranchesFromString
  - Должна возвращать массив строк
  - Должна возвращать строки без символа *
  - Должна возвращать не пустые строки
2. Функция utils/helpers/getBreadcrumbs
  - Должна возвращать массив объектов
  - Каждый объект имеет 2 поля - path, name
  - Первый элемент имеет вид {path: '', name: '/'}
3. Функция utils/helpers/getCommitsFromString
  - Должна возвращать массив объектов
  - Каждый объект имеет 4 поля - hash, date, author, message
  - Поле hash не должен содержать символа *
4. Функция utils/helpers/getFileNameFromPath
  - Должна возвращать строку
  - Должна возвращать последнее имя после /
  - Должна не возвращать символ /
5. Функция utils/helpers/getTreeFromString
  - Должна возвращать массив объектов
  - Каждый объект имеет 3 поля - type, path, name
  - Поле name не должен содержать символа /

##Интеграционное тестирование.
Для интеграционных тестов развернуто окружение на основе selenium и hermione

1. Главная страница:
  - Проверка title страницы
  - Проверка наличия списка веток
  - Переход на страницу отображения комитов ветки
2. Страница комитов ветки
  - Проверка title страницы
  - Проверка списка комиты ветки
  - Переход на страницу отображения списка файлов комита
  - Проверка наличия хлебных крошек
3. Страница отображения файлов ветки
  - Проверка title страницы
  - Проверка наличия списка файлов и директорий комита
  - Проверка наличия хлебных крошек
  - Переход на страницу отображения содержимого файла
4. Страница отображения содержимого файла
  - Проверка title страницы
  - Проверка наличия содержимого файла
  - Проверка наличия хлебных крошек
  - Переход на предыдующую страницу с помощью хлебных крошек
